{% extends "base.html" %}
{% block title %}Post a Job{% endblock %}
{% block content %}
<div class="form-container" style="max-width: 800px; margin: 0 auto;">
  <h1>Post a New Job</h1>
  <p class="form-description">Fill out the details below to post your job and start receiving applications.</p>

  <form method="post" class="job-form">
    {% csrf_token %}

    <!-- Job Basics -->
    <div class="form-section card">
      <h3>Job Basics</h3>
      <div class="form-grid">
        <div class="field">
          {{ form.title.label_tag }} {{ form.title }}
          {% if form.title.errors %}
            <ul class="errorlist">{% for error in form.title.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>

        <div class="field">
          {{ form.company.label_tag }} {{ form.company }}
          {% if form.company.errors %}
            <ul class="errorlist">{% for error in form.company.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>

        <div class="field" id="location-field">
          {{ form.location.label_tag }}
          <input
            type="text"
            id="id_location"
            name="location"
            list="us-cities"
            placeholder="City, State"
            required
            value="{{ form.location.value|default_if_none:'' }}"
          >
          {% if form.location.errors %}
            <ul class="errorlist">{% for error in form.location.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
          <datalist id="us-cities">
            <!-- A concise but realistic US cities list (capitals + major metros).
                You can extend this at any time; server-side validation matches this list. -->
            <option value="New York, NY"></option>
            <option value="Los Angeles, CA"></option>
            <option value="Chicago, IL"></option>
            <option value="Houston, TX"></option>
            <option value="Phoenix, AZ"></option>
            <option value="Philadelphia, PA"></option>
            <option value="San Antonio, TX"></option>
            <option value="San Diego, CA"></option>
            <option value="Dallas, TX"></option>
            <option value="San Jose, CA"></option>
            <option value="Austin, TX"></option>
            <option value="Jacksonville, FL"></option>
            <option value="San Francisco, CA"></option>
            <option value="Columbus, OH"></option>
            <option value="Fort Worth, TX"></option>
            <option value="Indianapolis, IN"></option>
            <option value="Charlotte, NC"></option>
            <option value="Seattle, WA"></option>
            <option value="Denver, CO"></option>
            <option value="Boston, MA"></option>
            <option value="Detroit, MI"></option>
            <option value="Nashville, TN"></option>
            <option value="Portland, OR"></option>
            <option value="Oklahoma City, OK"></option>
            <option value="Las Vegas, NV"></option>
            <option value="Memphis, TN"></option>
            <option value="Louisville, KY"></option>
            <option value="Baltimore, MD"></option>
            <option value="Milwaukee, WI"></option>
            <option value="Albuquerque, NM"></option>
            <option value="Tucson, AZ"></option>
            <option value="Fresno, CA"></option>
            <option value="Sacramento, CA"></option>
            <option value="Kansas City, MO"></option>
            <option value="Atlanta, GA"></option>
            <option value="Miami, FL"></option>
            <option value="New Orleans, LA"></option>
            <option value="Minneapolis, MN"></option>
            <option value="Saint Paul, MN"></option>
            <option value="Honolulu, HI"></option>
            <option value="Anchorage, AK"></option>
            <!-- State capitals -->
            <option value="Montgomery, AL"></option>
            <option value="Juneau, AK"></option>
            <option value="Phoenix, AZ"></option>
            <option value="Little Rock, AR"></option>
            <option value="Sacramento, CA"></option>
            <option value="Denver, CO"></option>
            <option value="Hartford, CT"></option>
            <option value="Dover, DE"></option>
            <option value="Tallahassee, FL"></option>
            <option value="Atlanta, GA"></option>
            <option value="Honolulu, HI"></option>
            <option value="Boise, ID"></option>
            <option value="Springfield, IL"></option>
            <option value="Indianapolis, IN"></option>
            <option value="Des Moines, IA"></option>
            <option value="Topeka, KS"></option>
            <option value="Frankfort, KY"></option>
            <option value="Baton Rouge, LA"></option>
            <option value="Augusta, ME"></option>
            <option value="Annapolis, MD"></option>
            <option value="Boston, MA"></option>
            <option value="Lansing, MI"></option>
            <option value="Saint Paul, MN"></option>
            <option value="Jackson, MS"></option>
            <option value="Jefferson City, MO"></option>
            <option value="Helena, MT"></option>
            <option value="Lincoln, NE"></option>
            <option value="Carson City, NV"></option>
            <option value="Concord, NH"></option>
            <option value="Trenton, NJ"></option>
            <option value="Santa Fe, NM"></option>
            <option value="Albany, NY"></option>
            <option value="Raleigh, NC"></option>
            <option value="Bismarck, ND"></option>
            <option value="Columbus, OH"></option>
            <option value="Oklahoma City, OK"></option>
            <option value="Salem, OR"></option>
            <option value="Harrisburg, PA"></option>
            <option value="Providence, RI"></option>
            <option value="Columbia, SC"></option>
            <option value="Pierre, SD"></option>
            <option value="Nashville, TN"></option>
            <option value="Austin, TX"></option>
            <option value="Salt Lake City, UT"></option>
            <option value="Montpelier, VT"></option>
            <option value="Richmond, VA"></option>
            <option value="Olympia, WA"></option>
            <option value="Charleston, WV"></option>
            <option value="Madison, WI"></option>
            <option value="Cheyenne, WY"></option>
            <option value="Washington, DC"></option>
          </datalist>
          <div id="remote-hint" class="field-help" style="display:none;">Work type is Remote — location will be set to “Remote”.</div>
        </div>

        <div class="field">
          {{ form.work_type.label_tag }} {{ form.work_type }}
          {% if form.work_type.errors %}
            <ul class="errorlist">{% for error in form.work_type.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Role Details -->
    <div class="form-section card">
      <h3>Role Details</h3>

      <div class="field">
        {{ form.description.label_tag }} {{ form.description }}
        {% if form.description.errors %}
          <ul class="errorlist">{% for error in form.description.errors %}<li>{{ error }}</li>{% endfor %}</ul>
        {% endif %}
      </div>

      <!-- Status & Visa on one row, vertically aligned -->
      <div class="form-grid" style="align-items:center;">
        <div class="field">
          {{ form.status.label_tag }} {{ form.status }}
          {% if form.status.errors %}
            <ul class="errorlist">{% for error in form.status.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>

        <div class="field">
          {{ form.visa_sponsorship.label_tag }} {{ form.visa_sponsorship }}
          {% if form.visa_sponsorship.errors %}
            <ul class="errorlist">{% for error in form.visa_sponsorship.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>
      </div>

      <div class="field" style="margin-top:16px;">
        {{ form.requirements.label_tag }} {{ form.requirements }}
        {% if form.requirements.errors %}
          <ul class="errorlist">{% for error in form.requirements.errors %}<li>{{ error }}</li>{% endfor %}</ul>
        {% endif %}
      </div>
    </div>

    <!-- Skills & Qualifications -->
    <div class="form-section card">
      <h3>Skills & Qualifications</h3>
      <div class="form-grid">
        <div class="field">
          {{ form.required_skills_csv.label_tag }} {{ form.required_skills_csv }}
          {% if form.required_skills_csv.help_text %}<div class="field-help">{{ form.required_skills_csv.help_text }}</div>{% endif %}
          {% if form.required_skills_csv.errors %}
            <ul class="errorlist">{% for error in form.required_skills_csv.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>

        <div class="field">
          {{ form.nice_to_have_skills_csv.label_tag }} {{ form.nice_to_have_skills_csv }}
          {% if form.nice_to_have_skills_csv.help_text %}<div class="field-help">{{ form.nice_to_have_skills_csv.help_text }}</div>{% endif %}
          {% if form.nice_to_have_skills_csv.errors %}
            <ul class="errorlist">{% for error in form.nice_to_have_skills_csv.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Compensation & Perks -->
    <div class="form-section card">
      <h3>Compensation & Perks</h3>
      <div class="form-grid">
        <div class="field">
          {{ form.salary_min.label_tag }} {{ form.salary_min }}
          {% if form.salary_min.errors %}
            <ul class="errorlist">{% for error in form.salary_min.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>

        <div class="field">
          {{ form.salary_max.label_tag }} {{ form.salary_max }}
          {% if form.salary_max.errors %}
            <ul class="errorlist">{% for error in form.salary_max.errors %}<li>{{ error }}</li>{% endfor %}</ul>
          {% endif %}
        </div>
      </div>

      <div class="field">
        {{ form.benefits.label_tag }} {{ form.benefits }}
        {% if form.benefits.errors %}
          <ul class="errorlist">{% for error in form.benefits.errors %}<li>{{ error }}</li>{% endfor %}</ul>
        {% endif %}
      </div>
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <button class="btn" type="submit">Save</button>
      <a class="btn btn-outline" href="{% url 'jobs:my_jobs' %}">Cancel</a>
    </div>
  </form>
</div>

<script>
  (function() {
    function byId(id){ return document.getElementById(id); }
    function updateLocationUI() {
      var sel = byId('id_work_type');
      var loc = byId('id_location');
      var hint = byId('remote-hint');
      if (!sel || !loc) return;
      if (sel.value === 'REMOTE') {
        loc.value = 'Remote';
        loc.setAttribute('readonly', 'readonly');
        loc.removeAttribute('list');
        if (hint) hint.style.display = 'block';
      } else {
        if (loc.value === 'Remote') loc.value = '';
        loc.removeAttribute('readonly');
        loc.setAttribute('list', 'us-cities');
        if (hint) hint.style.display = 'none';
      }
    }
    document.addEventListener('DOMContentLoaded', function() {
      var wt = document.getElementById('id_work_type');
      if (wt) {
        wt.addEventListener('change', updateLocationUI);
        updateLocationUI();
      }
    });
  })();
</script>

<style>
/* Keep the existing artstyle */
.form-container { padding: 0 16px; }
.form-description { color: #6b7280; margin: 0 0 16px; }
.form-section { margin-bottom: 24px; }
.form-section h3 { margin: 0 0 16px; color: #111827; font-size: 1.125rem; }
.form-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 16px; }
.field { display: flex; flex-direction: column; }
.field .field-help { color: #6b7280; font-size: 0.9rem; margin-top: 6px; }
.form-actions { display: flex; gap: 12px; margin-top: 24px; }
@media (max-width: 720px) { .form-grid { grid-template-columns: 1fr; } }
</style>
{% endblock %}
